FROM node:alpine AS builder

WORKDIR $HOME/mmdp

COPY ./package.json ./

COPY ./ ./

RUN yarn install

RUN yarn run build:client

CMD ["yarn", "run", "build:client"]


FROM nginx

COPY --from=builder $HOME/mmdp /usr/share/nginx

RUN rm /etc/nginx/conf.d/default.conf
COPY ./default.conf /etc/nginx/conf.d/default.conf

EXPOSE 80

CMD ["nginx", "-g", "daemon off;"]
